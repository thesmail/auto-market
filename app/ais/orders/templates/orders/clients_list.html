{% extends 'orders/base_orders.html' %}

{% block title %}
Клиенты - {{block.super}}
{% endblock %}

{% block content %}

{% include "orders/_modal.html" %}
<div class="container">
  <div class="row mt-5">
    <div class="col-sm">
      <h1 class='mb'>Клиенты:</h1>
    </div>
    <!-- <div class="col-sm text-right mt-2">
      <form class="form-inline my-2 my-lg-0">
        <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
      </form>
    </div> -->
    <div class="col-sm text-right mt-2">
      <button type="button" class="create-client btn btn-success" data-toggle="modal" data-target="#exampleModal">Добавить</button>
    </div>
  </div>

  <table id="table" class="table table-striped table-hover table-bordered">
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col" data-sort-default>ФИО</th>
        <th scope="col">Телефон</th>
        <th scope="col">Долг</th>
        <th scope="col" data-sort-method='none'></th>
      </tr>
    </thead>
    <tbody>
      {% for client in clients %}
      <tr>
        <th scope="row">{{ client.id}}</th>
        <td>
          <h6><a href="{{ client.get_absolute_url }}">{{ client.last_name }} {{ client.first_name }} {{ client.fath_name }}</a>
            {% if client.label %}
            <span class="badge badge-danger">{{ client.get_label_display }}</span>
            {% endif %}
          </h6>
        </td>
        <td>+{{ client.phone }}</td>
        <td>{{ client.note_c }}</td>
        <td>
          <button type="button" class="update-client btn btn-sm btn-primary" data-id="{% url 'update_client' client.pk %}">
            <span class="fa fa-pencil"></span>
          </button>
          <button type="button" class="delete-client btn btn-sm btn-danger" data-id="{% url 'delete_client' client.pk %}">
            <span class="fa fa-trash"></span>
          </button>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% block extrascripts %}
<script type="text/javascript">
  $(function() {

    $(".create-client").modalForm({
      formURL: "{% url 'create_client' %}",
      modalID: "#create-modal"
    });

    // Update book buttons
    $(".update-client").each(function() {
      $(this).modalForm({
        formURL: $(this).data('id')
      });
    });

    // Delete book buttons
    $(".delete-client").each(function() {
      $(this).modalForm({
        formURL: $(this).data('id')
      });
    })

    // Hide message
    $(".alert").fadeTo(2000, 500).slideUp(500, function() {
      $(".alert").slideUp(500);
    });

  });

  $(function() {
    //2. Получить элемент, к которому необходимо добавить маску
    $("#phone").mask("+7(999)999-99-99", {
      placeholder: "99219"
    });
  });
  // jQuery(function($) {
  //    $("input[id=phone]").mask("+38(099) 99-99-999");
  //  });

  new Tablesort(document.getElementById('table'));
</script>

{% endblock extrascripts %}

{% endblock %}
